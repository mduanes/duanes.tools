#' @name manual_breaks
#' @export

# classifies data based on manually set breaks

manual_breaks <- function(data,
                          field, # field to classify
                          breaks=c(), # set of breaks
                          class_name="classified" # name of output class
                          ) {

  # get field data
  field_fun <- data %>%
    dplyr:: pull(field)
  # set classes based on breaks
  classes <- breaks
  # count length of classes for loop
  n <- length(classes)

  # loop over each class and classify
  for(i in 1:n) {
    # special code for first class
    if (i == 1) {
      # make class label
      class_lab <- paste0(format(classes[i],big.mark=","), " - ", format(classes[i+1]-1,big.mark=","))
      # start order vector
      order <- class_lab
      data_out <- data %>%
        # rename field to be classified to generic name
        dplyr::rename("field_class"=sym(field)) %>%
        # classify
        dplyr::mutate(classified=dplyr::case_when(field_class >= classes[i] & field_class < classes[i+1]~class_lab,
                                    TRUE~NA))
      # intermediate classes
    } else if (i != n) {
      # class label
      class_lab <- paste0(format(classes[i],big.mark=","), " - ", format(classes[i+1]-1,big.mark=","))
      # add to order vector
      order <- c(order,class_lab)
      # classify
      data_out <- data_out %>%
        dplyr::mutate(classified=dplyr::case_when(field_class >= classes[i] & field_class < classes[i+1]~class_lab,
                                    TRUE~classified))
      # final label
    } else {
      # class label (X+ instead of X-Y)
      class_lab <- paste0(format(classes[i],big.mark=","), " + ")
      # add to order vector
      order <- c(order,class_lab)
      # classify
      data_out <- data_out %>%
        dplyr::mutate(classified=dplyr::case_when(field_class >= classes[i]~class_lab,
                                    TRUE~classified))
    }
  }

  # order class factor based on order vector
  data_out <- data_out %>%
    dplyr::mutate(classified=factor(classified,order))

  # reset names and properly name class factor
  colnames(data_out) <- c(colnames(data),class_name)

  # output classified data
  data_out
}

