#' @name install_adg_key
#' @export
#'
#'


# installs adg key in r environment for future reference

install_adg_key <- function(key) {
  # get r environment
    home <- Sys.getenv("HOME")
    renv <- file.path(home, ".Renviron")

    # backup if applicable
    if (file.exists(renv)) {
      file.copy(renv, file.path(home, ".Renviron_backup"))
    }
    if (!file.exists(renv)) {
      file.create(renv)
    }
    # save key in renvironment
    key_save <- paste0("ADG_KEY='", key, "'")
    write(key_save, renv, sep = "\n", append = TRUE)
    Sys.setenv(ADG_KEY = key)

    # output message
    message("ADG path stored. Accessible via Sys.getenv(\"ADG_KEY\").")
}
